<script src="http://code.highcharts.com/highcharts.js"></script>
<div class="container-fluid">
	<div class="well col-md-4">
		<div class="demotitle">
			<img class="logo pull-left" title="Ocelotds" src="../../assets/ocelot_128x128.png" alt="Ocelotds"/>
			<img src="http://www.highcharts.com/media/templates/highsoft_bootstrap/images/logo.svg" width="300" alt="HighChart"/>
		</div>
		<div id="graph-area" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
	</div>
	<div class="well col-md-8">
		<!-- Nav tabs -->
		<ul class="nav nav-tabs" role="tablist">
			<li role="presentation" class="active"><a href="#about"	aria-controls="about"	role="tab" data-toggle="tab">About</a></li>
			<li role="presentation">					<a href="#java1"	aria-controls="java1"	role="tab" data-toggle="tab">ChartServices.java</a></li>
			<li role="presentation">					<a href="#java2"	aria-controls="java2"	role="tab" data-toggle="tab">DataMarshaller.java</a></li>
			<li role="presentation">					<a href="#js1"		aria-controls="js1"		role="tab" data-toggle="tab">Javascript</a></li>
			<li role="presentation">					<a href="#html1"	aria-controls="html1"	role="tab" data-toggle="tab">Html</a></li>
		</ul>
		<!-- Tab panes -->
		<div class="tab-content">
			<div role="tabpanel" class="tab-pane active" id="about">
				<h2>About demo : HighChart and <span style="color:gray">Ocelot</span><span style="color:chocolate">ds</span>...</h2>
				<p>This is a demonstration base on <a href="http://www.highcharts.com/demo/dynamic-update">highcharts</a>.<br>With Ocelot your front end application communicate elegantly with your java back-end</p>
				<p>This show how to implement a simple dynamic chart.</p>
				<p>Hover the mouse <span class="cc" title="That's it !!!">&nbsp;highlighted code&nbsp;</span> and get infos about it</p>
			</div>
			<div role="tabpanel" class="tab-pane" id="java1">
				<p>Hover the mouse <span class="cc" title="That's it !!!">&nbsp;highlighted code&nbsp;</span> and get infos about it</p>
				<pre><code class="java">@Singleton
@Startup
public class ChartServices {
   <b class="cc" title="Inject the events dispacher">@Inject</b>
   <b class="cc" title="Specify the topic">@JsTopicEvent("values")</b>
   <b class="cc" title="Specify the marshaller if you want">@JsonMarshaller(DataMarshaller.class)</b>
   Event&lt;Object&gt; wsEvent;

   @Schedule(dayOfWeek = "*", month = "*", hour = "*", dayOfMonth = "*", year = "*", minute = "*", second = "*/1", persistent = false)
   public void getValues() {
      Random randomGenerator = new Random();
      <b class="cc" title="Dispatch payload to all clients">topicEvent.fire</b>(new Object[]{new Date(), randomGenerator.nextFloat()});
   }
}</code></pre>
			</div>
			<div role="tabpanel" class="tab-pane" id="java2">
				<p>Hover the mouse <span class="cc" title="That's it !!!">&nbsp;highlighted code&nbsp;</span> and get infos about it</p>
				<pre><code class="java">public class DataMarshaller implements JsonMarshaller&lt;Object&gt;{
   @Override
   public String toJson(Object obj) throws JsonMarshallingException {
      Object[] datas = (Object[]) obj;
      Date d = (Date) datas[0];
      float f = (float) datas[1];
      return String.format("[%s,%s]", d.getTime(), f);
   }
}</code></pre>
			</div>
			<div role="tabpanel" class="tab-pane" id="js1">
				<p>Hover the mouse <span class="cc" title="That's it !!!">&nbsp;highlighted code&nbsp;</span> and get infos about it</p>
				<pre><code class="js">'use strict';
var chart;
<b class="cc" title="Observe when the websocket connection is open">ocelotController.addOpenListener</b>(function () {
   Highcharts.setOptions({
      global: {
         useUTC: false
      }
   });
   chart = new Highcharts.Chart({
      chart: {
         renderTo: 'graph-area',
         type: 'spline',
         animation: Highcharts.svg, // don't animate in old IE
         marginRight: 10,
         events: {
            load: function () {
               <b class="cc" title="Subscribe to topic named 'values'">new Subscriber("values")</b>.message(<b class="cc" title="Handler when message is post in topic">function</b> (vals) {
                  chart.series[0].addPoint([vals.time, vals.value], true, true);
               });
            }
         }
      },
      title: {
         text: 'Live random data'
      },
      xAxis: {
         type: 'datetime',
         tickPixelInterval: 150
      },
      yAxis: {
         title: {
            text: 'Value'
         },
         plotLines: [{
               value: 0,
               width: 1,
               color: '#808080'
            }]
      },
      tooltip: {
         formatter: function () {
            return '&lt;b&gt;' + this.series.name + '&lt;/b&gt;&lt;br/&gt;' +
               Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '&lt;br/&gt;' +
               Highcharts.numberFormat(this.y, 2);
         }
      },
      legend: {
         enabled: false
      },
      exporting: {
         enabled: false
      },
      series: [{
            name: 'Random data',
            data: (function () {
               // generate an array of random data
               var data = [],
                  time = (new Date()).getTime(),
                  i;
               for (i = -19; i <= 0; i += 1) {
                  data.push({
                     x: time + i * 1000,
                     y: Math.random()
                  });
               }
               return data;
            }())
         }]
   });
});
</code></pre>
			</div>
			<div role="tabpanel" class="tab-pane" id="html1">
				<p>Hover the mouse <span class="cc" title="That's it !!!">&nbsp;highlighted code&nbsp;</span> and get infos about it</p>
				<pre><code class="html">&lt;script src="http://code.highcharts.com/highcharts.js"&gt;&lt;/script&gt;
...
&lt;div id="graph-area" style="min-width: 310px; height: 400px; margin: 0 auto"&gt;&lt;/div&gt;</code></pre>
			</div>
		</div>
	</div>
</div>
<script src="charts.js"></script>

